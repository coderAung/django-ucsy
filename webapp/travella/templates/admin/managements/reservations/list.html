{% extends 'layouts/admin-layout.html' %}

{% load static %}


{% block cssFile %}
    <link rel="stylesheet" href="{% static 'css/pagination2.css' %}">
{% endblock cssFile %}

{% block content %}
<div class="container py-3">
    <div class="mb-4">
        <h4 class="df-text-green">Payment Requests</h4>
    </div>
    <div>
        <div>
            <form>
                <div class="mb-3 d-flex justify-content-between">
                    <div class="d-flex flex-fill column-gap-2">
                        <div class="input-group" style="width: 60%;">
                            <select name="type" class="form-select">
                                <option value="email" 
                                {% if request.GET.type == 'email' %}
                                    {{'selected'}}
                                {% endif %}>Email</option>
                                <option value="booking_code"
                                {% if request.GET.type == 'booking_code' %}
                                    {{'selected'}}
                                {% endif %}>Booking Code</option>
                            </select>
                            <input type="text" class="form-control w-auto" name="q" placeholder="Search with email or booking code" value="{{request.GET.q}}">
                        </div>
                        <button id="searchBtn" type="submit" class="btn df-btn-glass-purple">Search</button>
                    </div>
                    <div class="btn-group align-self-end">
                        <input type="radio" id="requesting" class="btn-check" name="payment_status" value="requesting" 
                        {% if not request.GET.payment_status  %}
                            checked
                        {% else %}
                            {% if request.GET.payment_status == 'requesting' %}
                                checked
                            {% endif %}
                        {% endif %}>
                        <label id="requestingTab" for="requesting" class="btn btn-sm btn-outline-primary fw-bold">Requesting</label>

                        <input type="radio" id="reserved" class="btn-check" name="payment_status" value="reserved"
                        {% if request.GET.payment_status == 'reserved' %}
                            checked
                        {% endif %}>
                        <label id="reservedTab" for="reserved" class="btn btn-sm btn-outline-primary fw-bold">Reserved</label>
                    </div>
                    <input id="pageInput" class="d-none" type="number" name="page">
                </div>
                <script src="{% static 'js/reservation-list.js' %}"></script>
            </form>
        </div>
        
        {% if messages %}
            {% for message in messages %}
                <div class="df-alert df-alert-red mb-3">{{message}}</div>
            {% endfor %}
        {% endif %}

        <div>
            <table class="table table-striped table-hover df-fs-sm">
                <thead>
                    <tr class="align-middle table-secondary">
                        <th>No.</th>
                        <th>Email</th>
                        <th>Name</th>
                        <th>Phone</th>
                        <th>Booking Code</th>

                        <th>Booking Date</th>
                        <th>Request Date</th>
                        <th>Status</th>
                        <th>Type</th>
                        <th></th>
                    </tr>
                </thead>

                <tbody>
                    
                    {% for item in list %}
                        <tr class="align-middle">
                            <td>{{forloop.counter}}</td>
                            <td>{{item.email}}</td>
                            <td>{{item.name}}</td>
                            <td>{{item.phone}}</td>

                            <td>{{item.booking_code}}</td>
                            <td>{{item.booking_date}}</td>
                            <td>{{item.request_date}}</td>
                            <td><span class="df-badge 
                            {% if item.status == 'Requesting' %}
                                {{'badge-purple'}}
                            {% else %}
                                {{'badge-green'}}
                            {% endif %}">{{item.status}}</span></td>
                            <td>{{item.payment_type}}</td>
                            <td>
                                <a href="{% url 'reservations_detail' item.reservation_id %}" class="btn btn-sm df-btn-glass-blue">
                                    <i class="bi bi-eye df-text-blue"></i>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div>
            <div class="d-flex justify-content-end">
                {% include 'includes/pagination2.html' %}
            </div>
        </div>
    </div>
</div>
{% endblock content %}