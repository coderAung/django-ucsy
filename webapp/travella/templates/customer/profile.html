{% extends 'layouts/customer-layout.html' %}

{% load static %}


{% block title %}
    Profile
{% endblock title %}
    

{% block cssFile %}
<style>
#profileImage:hover {
    filter: brightness(0.85);
}

#uploadBtn:hover {
    backdrop-filter: brightness(0.9);
}
</style>
{% endblock cssFile %}
    

{% block content %}
    <div class="container py-4">
        <div class="row">
            <div class="col-4">
                <div class="shadow rounded px-2 py-3">
                    <div id="profileImageWrapper" class="text-center position-relative">
                        <div class="position-absolute"
                        style="top: 0; right: 0; margin-top: -20px;"
                        >
                            <form id="profileImageForm" action="{% url 'profile_image_upload' %}" enctype="multipart/form-data" class="d-none">
                                {% csrf_token %}
                                <input type="file" name="profileImage" id="profileImageInput">
                            </form>
                            <div class="rounded px-2 pointer df-text-blue mt-3" id="uploadBtn">
                                
                                {% if profile_data.profile_image %}
                                    <i class="bi bi-repeat df-text-blue fs-5"></i>
                                {% else %}
                                    <i class="bi bi-camera df-text-blue fs-5"></i>
                                {% endif %}
                                    
                            </div>
                            <script src="{% static 'js/c/profile.js' %}"></script>
                        </div>
                        <div class="overflow-hidden bg-danger mx-auto" style="width: 250px; height: 250px; border-radius: 50%;">
                            <img id="profileImage" src="{% if profile_data.profile_image %} {{profile_data.profile_image}} {% else %} https://cdn.pixabay.com/photo/2019/08/11/18/59/icon-4399701_1280.png {% endif %}" alt=""
                            style="width: 100%; height: 100%; object-fit: cover;">
                        </div>
                    </div>
                    <div class="mt-3">
                        <div class="d-flex flex-column row-gap-3 px-3 py-2">
                            <div class="fs-6 fw-bold border-bottom border-primary py-2">{{profile_data.name}}</div>
                            <div class="fs-6 fw-bold border-bottom border-primary py-2">{{profile_data.email}}</div>
                            <div class="fs-6 fw-bold border-bottom border-primary py-2">{{profile_data.phone}}</div>
                            <div class="fs-6 fw-bold border-bottom border-primary py-2">{{profile_data.address}}</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-8">
                <div>
                    <div class="shadow rounded py-2 px-3">
                        <div class="fs-5 fw-bold">Booking Status</div>
                        <div class="container-fluid py-4">
                            <div class="row row-cols-2 row-gap-4">
                                <div class="col">
                                    <div class="df-alert df-alert-green border-0 mx-auto p-2 rounded text-center">
                                        <div class="fs-4 fw-bold df-text-green">{{booking_status.reserved_bookings}}</div>
                                        <div class="fs-6 mt-3">Reserved</div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="df-alert df-alert-purple border-0 mx-auto p-2 rounded text-center">
                                        <div class="fs-4 fw-bold df-text-purple">{{booking_status.requesting_bookings}}</div>
                                        <div class="fs-6 mt-3">Requesting</div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="df-alert df-alert-blue border-0 mx-auto p-2 rounded text-center">
                                        <div class="fs-4 fw-bold df-text-blue">{{booking_status.pending_bookings}}</div>
                                        <div class="fs-6 mt-3">Pending</div>
                                    </div>
                                </div>
                                <div class="col">
                                    <div class="df-alert df-alert-red border-0 mx-auto p-2 rounded text-center">
                                        <div class="fs-4 fw-bold df-text-red">{{booking_status.cancelled_bookings}}</div>
                                        <div class="fs-6 mt-3">Cancelled</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end">
                            <a href="{% url 'customer_booking_history' %}" class="btn btn-sm df-btn-glass-blue">View All</a>
                        </div>
                    </div>

                    <div class="shadow rounded py-2 px-3 mt-5">
                        <div class="fs-5 fw-bold">Tour Reminders</div>
                        <div class="mt-3 d-flex flex-column row-gap-2">
                            {% if tour_reminders %}
                                {% for i in tour_reminders %}
                                <div class="p-2 border-bottom">
                                    <i class="fas fa-check-square df-text-green fs-5 me-3"></i> {{i}}
                                </div>
                                {% endfor %}
                                    
                            {% else %}
                                <div class="p-2 border-bottom">
                                    <div>No Tour for now</div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
{% endblock content %}
    