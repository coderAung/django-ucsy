{% extends "layouts/customer-layout.html" %}
{% load static %}
{% block content %}

<div class="container-fluid mt-2">
    <div class="row g-5 justify-content-center d-flex align-items-stretch">
<div class="col-md-5 mb-4">
    <div class="row g-3">
        
        <div class="col-12">
            <h4 class="card-title text-center fw-bold mb-3">Tour Details</h4>
        </div>
        
        <div class="col-12">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">üó∫Ô∏è Trip Name:</strong>
                            <span id="tourPackageTitle" class="fw-bold mt-1">{{ package.title }}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">‚è≥ Duration:</strong>
                            <span class="fw-bold mt-1">{{ package.duration }} days</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-12">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">üìÖ Departure Date:</strong>
                            <span id="tourDate" class="fw-bold mt-1">{{ departure_date }}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">üóìÔ∏è End Date:</strong>
                            <span id="tourEndDate" class="fw-bold mt-1">{{ tour_end_date }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-12">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">üöó Transportation:</strong>
                            <span class="fw-bold mt-1">{{ package.get_transportation_display }}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">üí∞ Price per Seat:</strong>
                            <span class="fw-bold mt-1">{{ price_per_seat }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-12">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">üé´ Total Seats:</strong>
                            <span class="fw-bold mt-1">{{ package.total_tickets }}</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card shadow-sm rounded-3 h-100">
                        <div class="card-body p-3 d-flex flex-column">
                            <strong class="text-muted">‚úÖ Available Seats:</strong>
                            <span id="availableSeatsValue" class="fw-bold mt-1">{{ available_seats }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        <div class="col-md-5">
            <div class="card h-100 border-0 shadow-lg rounded-4">
                <div class="card-header bg-primary text-white py-3 rounded-top-4 border-0" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)">
                    <h4 class="card-title text-center fw-bold mb-0">Booking Form</h4>
                </div>
                <div class="card-body p-4 bg-light">
                    <form id="bookingForm" method="post" action="{% url 'booking_save' %}">
                        {% csrf_token %}
                        <input type="hidden" name="package_id" value="{{ package.id }}">
                        <input type="hidden" id="pricePerSeat" value="{{ package.price }}">

                        <div class="mb-3">
                            <label for="fullName" class="form-label fw-bold text-dark">Full Name:</label>
                            <input type="text" class="form-control rounded-pill px-3 py-2 bg-white" name="fullName" id="fullName" value="{{ user_name }}" readonly required>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label fw-bold text-dark">Email:</label>
                            <input type="email" class="form-control rounded-pill px-3 py-2 bg-white" name="email" id="email" value="{{ user_email }}" readonly required>
                        </div>
                        <div class="mb-3">
                            <label for="phone" class="form-label fw-bold text-dark">Phone Number:</label>
                            <input type="tel" class="form-control rounded-pill px-3 py-2 bg-white" name="phone" id="phone" value="{{ user_phone }}" readonly required>
                        </div>

                        <div class="row g-3 align-items-end mb-4">
                            <div class="col-lg-6">
                                <label for="people" class="form-label fw-bold text-dark">Number of People:</label>
                                <div class="input-group">
                                    <button type="button" class="btn rounded-pill px-3 py-2 border-0" id="decreasePeople" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);">
                                        <i class="bi bi-dash-lg text-white"></i>
                                    </button>
                                    <input type="text" class="form-control text-center fw-bold border-0 bg-white" name="ticket_count" id="people" value="1" required>
                                    <button type="button" class="btn rounded-pill px-3 py-2 border-0" id="increasePeople" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%);">
                                        <i class="bi bi-plus-lg text-white"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-lg-6">
                                <label for="totalPrice" class="form-label fw-bold text-dark">Total Price:</label>
                                <input type="text" class="form-control rounded-pill px-3 py-2 bg-white" id="totalPrice" readonly>
                            </div>
                        </div>

                        <div class="text-center">
                            <button type="button" id="showReceiptBtn" class="btn btn-primary text-white fw-bold rounded-pill px-4 py-2 shadow-sm" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)">
                                Confirm Booking
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</div>
<!-- Confrim modal -->
<div class="modal fade" id="receiptConfirmationModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-md">
    <div class="modal-content border-0 shadow-lg">
      <div class="modal-header bg-primary text-white py-3 position-relative text-center" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)">
        <h5 class="modal-title fw-bold">Booking Confirmation</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-4">
        <div class="text-center mb-3">
          <h4 class="fw-bold text-primary">TRAVELLA</h4>
          <p class="mb-0 text-muted">Booking Receipt</p>
        </div>

       <div class="d-flex justify-content-between align-items-center mb-3 border-bottom pb-2">
    <div class="text-start">
        <p class="mb-0"><small class="text-uppercase fw-bold text-muted">Pending Date:</small> <br> <span id="receiptDate" class="fw-bold"></span></p>
    </div>
    
    <div class="text-end">
        <p class="mb-0"><small class="text-uppercase fw-bold text-muted">Auto Cancel Date:</small> <br> <span id="receiptCancelDate" class="fw-bold text-danger">After 24 hours</span></p>
    </div>
</div>

        <h6 class="fw-bold mt-4 mb-2">Customer & Trip Details</h6>
        <ul class="list-group list-group-flush mb-4">
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Name:</small>
              <span id="receiptName" class="text-end"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Email:</small>
              <span id="receiptEmail" class="text-end"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Phone:</small>
              <span id="receiptPhone" class="text-end"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Package:</small>
              <span id="receiptPackage" class="text-end fw-bold"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Departure Date:</small>
              <span id="receiptDeparture" class="text-end"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
      <small class="text-muted fw-bold">Tour End Date:</small>
      <span id="receiptEndDate" class="text-end"></span>
    </li>

            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Travelers:</small>
              <span id="receiptTravelers" class="text-end"></span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center py-2">
              <small class="text-muted fw-bold">Status:</small>
              <span class="badge bg-info text-dark">Pending</span>
            </li>
        </ul>

        <div class="text-end mb-3">
          <h5 class="fw-bold text-dark">Total: <span id="receiptTotal" class="text-primary"></span></h5>
        </div>

      </div>
      <div class="modal-footer d-flex justify-content-between">
        <button type="button" class="btn btn-primary" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)" data-bs-dismiss="modal">
          Cancel
        </button>
        <button type="button" class="btn btn-primary" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)" id="confirmSaveBtn">
          Confirm Booking
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Alert warning message -->
<div class="modal fade" id="alertModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header text-white" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)">
                <h5 class="modal-title" id="alertTitle" >Alert</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="alertMessage">
                Sorry ! Not enough seat!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" style="background: linear-gradient(to right, #4facfe 0%, #00f2fe 100%)" data-bs-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'js/customer.js' %}"></script>

{% endblock %}


{% block footer %}
    
{% endblock footer %}
    